<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
  <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
  <title></title>
  <link rel="stylesheet" href="../../../assets/css/api.css"/>
  <link rel="stylesheet" href="../../../assets/css/style.css">
  <link rel="stylesheet" href="../../../assets/iconfont/iconfont.css">
  <style>
    #app {
      background: #f0f0f0;
    }

    html, body {
      width: 100%;
      height: 100%;
      background: #f0f0f0;
    }

    #app {
      height: 100%;
    }

    .headernav {
      display: flex;
      font-size: 14px;
      background: white;
      line-height: 2rem;
    }

    .headernav div {
      flex: 1;
      text-align: center;
    }

    .spanbefore {
      border-bottom: 2px solid saddlebrown;
      color: saddlebrown;
    }

    .navoul {
      width: 100%;
      height: 1.5rem;
      display: flex;
      background: white;
      margin-top: 0.5rem;
      z-index: 100;
      padding-top: 10px;
      padding-bottom: 10px;
    }

    .navoul li {
      flex: 1;
      text-align: center;
      font-size: 14px;
      padding-top: 5px;
      padding-bottom: 5px;
      line-height: 1rem;
      z-index: 100;
      color: #585858;
      border-right: 1px solid #d9d9d9;
    }

    .navoul li:nth-child(4) {
      border-right: 1px solid transparent;
    }

    .firstlable {
      width: 100%;
      height: auto;
      background: white;
    }

    .firstlable li {
      line-height: 3rem;
      padding-left: 0.5rem;
      font-size: 15px;
      box-sizing: inherit;
      border-top: 1px solid gainsboro;
      z-index: 100;
    }

    .firstlable li:active {
      background: gainsboro;
    }

    .changebox {
      width: 3.5rem;
      height: 1.2rem;
      font-size: 12px;
      color: #838383;
      text-align: center;
      line-height: 1.2rem;
      border-radius: 20px;
      border: 1px solid #838383;
      padding: 3px;
      display: inline-block;
      margin-left: 0.5rem;
      z-index: 100;
    }

    .beforeclass {
      border: 1px solid #ff3c00;
      color: #ff3c00;
    }

    .datacount {
      width: 100%;
      height: auto;
    }

    .shopcount {
      width: 100%;
      height: 6rem;
      background: white;
      padding: 0.5rem;
      margin-top: 0.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-sizing: border-box;
    }

    .left-img {
      width: 4rem;
      height: 4rem;
      margin: 1rem 0;
      flex-shrink: 0;
      box-sizing: border-box;
    }

    .left-img img {
      width: 100%;
      height: 100%;
    }

    .right-content {
      flex: 1;
      height: 4rem;
      margin-left: 10px;
      box-sizing: border-box;
      overflow: hidden;
    }

    .right-content h3 {
      font-size: 16px;
      font-weight: normal;
      color: #00c;
      box-sizing: border-box;
    }

    .right-content p {
      width: 100%;
      font-size: 12px;
      color: #555;
      box-sizing: border-box;
      display: -webkit-box;
      overflow: hidden;
      text-overflow: ellipsis;
      word-wrap: break-word;
      white-space: normal !important;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .oimg {
      width: 5rem;
      display: inline-block;
      height: 5rem;
    }

    .ableimg {
      width: 5rem;
      margin-left: 0.5rem;
      display: inline-block;
      height: 6rem;
      float: left;
      text-align: center;
    }

    .textcount {
      flex: 1;
      height: 100%;
      float: left;
      font-size: 14px;
      margin-left: 0.5rem;
      display: inline-block;
    }

    .countp {
      width: 100%;
      padding-bottom: 0.2rem;
      height: auto;
      font-size: 16px;
      font-weight: bold;
    }

    .ableop {
      font-size: 15px;
      color: #585858;
      width: 100%;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .ospan {
      display: inline-block;
      border: 1px solid orangered;
      color: orangered;
      font-size: 10px;
      padding: 2px;
      box-sizing: border-box;
      border-radius: 2px;
    }

    .storespan {
      display: inline-block;
      padding: 2px;
      border: 1px solid #777777;
      color: #777777;
      font-size: 12px;
      margin-bottom: 0.5rem;
      margin-top: 1rem;
    }

    .oi {
      font-size: 12px;
      display: flex;
      justify-content: space-between;
    }

    .oi i {
      font-size: 10px;
      padding: 0;
    }

    .kmitle {
      display: inline-block;
      font-size: 11px;
      color: #5a5a5a;
    }

    .pricehour {
      color: #ff3c00;
      font-weight: bold;
      font-size: 16px;
      line-height: 1.5rem;
      border-bottom: 1px solid gainsboro;
    }

    .option {
      float: left;
      display: inline-block;
      height: 100%;
      line-height: 1.5rem
    }

    /*.modal {*/
    /*position: fixed;*/
    /*width: 100%;*/
    /*height: 100%;*/
    /*background: black;*/
    /*opacity: 0.5;*/
    /*top: 0;*/
    /*left: 0;*/
    /*z-index: 10;*/
    /*}*/
    .navboxtitle {
      width: 100%;
      height: 3rem;
      display: flex;
      line-height: 3rem;
      background: white;
      margin-top: 0.5rem;
      padding: 0 5px;
      justify-content: space-between;
      box-sizing: border-box;
    }

    .abletodo {
      /*flex: 1;*/
      font-size: 13px;
      text-align: center;
    }

    .beofrediv {
      color: #F46C5A;
    }

    .news {
      width: 100%;
      height: auto;
      padding: 10px;
      box-sizing: border-box;
    }

    .newsimgbox {
      width: 100%;
      height: 8rem;
    }

    .newsimgbox img {
      width: 100%;
      height: 100%;
    }

    .ofasty {
      text-align: right;
      font-size: 14px;
      line-height: 2rem;
    }

    .ofasty span {
      margin-right: 0.5rem;
    }

    .strongpeople {
      width: 100%;
      height: auto;
      padding: 10px;
      box-sizing: border-box;
    }

    .peopledetails {
      width: 50%;
      height: 8rem;
      float: left;
      text-align: center;
      margin-top: 0.5rem;
    }

    .imgdetails {
      width: 6rem;
      height: 6rem;
      display: inline-block;
    }

    .rotg {
      color: darkgray;
    }

    .navlist li:active {
      background: gainsboro;
    }

    .shopcount1 {
      margin: 0.5rem auto 0;
      background-color: #fff;
      width: 90%;
      box-sizing: border-box;
    }

    .culWrap {
      position: relative;
      width: 100%;
      height: 8rem;
      background-repeat: no-repeat;
      background-position: center;
      background-size: cover;
    }

    .culWrap p {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 2rem;
      line-height: 2rem;
      background-color: #000;
      opacity: 0.5;
      padding: 0 5px;
      box-sizing: border-box;
      color: #fff;
      font-size: 16px;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .edittime {
      width: 100%;
      box-sizing: border-box;
      height: 2rem;
      line-height: 1rem;
      text-align: right;
      padding: 0 5px;
      font-size: 12px;
    }

    .bottomdiv {
      width: 100%;
      height: 2rem;
      text-align: center;
      line-height: 2rem;
      background: #f0f0f0;
      color: black;
    }

    .uptext {
      color: #bfbfbf;
      font-size: 13px;
    }

    .publicfont {
      width: 20px;
      height: 20px;
      margin: auto;
    }

    /*推荐头*/
    .liketitle {
      width: 100%;
      height: 2.5rem;
      display: flex;
      justify-content: space-between;
      box-sizing: border-box;
      padding: 5px 10px;
      align-items: center;
    }

    .liketitle p {
      font-size: 12px;
      color: #111;
    }

    .liketitle span {
      font-size: 12px;
      color: #ccc;
      border: 1px solid #CCCCCC;
      padding: 2px;
    }

    /*推荐内容*/
    .pricetitle{
      line-height: 1.5rem;
      color: #5a5a5a;
      font-size: 12px
    }
    .clubscore{
      color:#ff8500;
      margin-left: 0.2rem;
      font-size: 14px
    }
    .shop {
      width: 100%;
      height: 7.5rem;
      background: white;
      padding-top: 0.5rem;
      margin-top: 5px;
      display: flex;
    }

    .star {
      font-size: 13px;
      line-height: 1.5rem;
    }

    .star .iconfont {
      margin-right: 2px;
    }

    .distance {
      display: inline-block;
      float: right;
      font-size: 14px;
      margin-right: 0.5rem;
      color: #b3b3b3;
    }

    .tagspan {
      display: inline-block;
      padding: 2px;
      border: 1px solid #777777;
      color: #777777;
      font-size: 12px;
      margin-bottom: 0.5rem;
      margin-top: 0.5rem;
      border-radius: 2px;
    }
  </style>
</head>
<body>
<div id="loadStart"></div>
<div id="app">
  <div :class="{modal: minindex !== -1}"></div>

  <div class="headernav">
    <div v-for="(item,index) in headerlist"><span style="text-align: center" :class="{spanbefore:headerindex==index}"
                                                  @click="headerbtn(index)">{{item.name}}</span></div>
  </div>
  <!--不是文化的时候的商品-->
  <div class="datacount" v-if="headerindex!==3">
    <!--琴馆-->
    <div class="storebox" v-if="headerindex==0">
      <div class="shopcount" v-if="ifClub">
        <h3 style="height: 5rem;line-height: 5rem;text-align: center;width: 100%;font-size: 16px;color: #8d8d8d;">
          对不起，没有搜索到合适的琴馆！</h3>
      </div>
      <div class="liketitle" v-if="ifClub">
        <p>您可能喜欢</p><span>广告</span>
      </div>
      <div class="storebox" v-if="ifClub">
        <div class="shop" v-for="(item,index) in clubs1" @click="gotoclubs(2,index)">
          <div class="ableimg">
            <img class="oimg" :src="formatImg(item.picName)"/>
          </div>

          <div class="textcount">

            <div class="countp">
              {{item.clubName}}
            </div>

            <div class="star">
              <i style="color: #ff8500" class="iconfont icon-xingxing1" v-for="i in parseInt(item.overallScore)"></i><i
                    style="color: #bfbfbf" class="iconfont icon-xingxing1"
                    v-for="i in (5 - parseInt(item.overallScore))"></i>
              <span class="clubscore">{{item.overallScore}} / 5</span>
              <span class="distance">{{item.distance}}km</span>
            </div>

            <div>
              <span class="tagspan" v-show="item.dueTime == '1'">售后服务</span>
              <span class="tagspan" v-show="item.operateYear>0">{{item.operateYear}}年店</span>
              <span class="tagspan" v-show="item.isFree == '1'">免费体验课</span>
              <span class="tagspan" v-show="item.isBrand == '1'">品牌店</span>
            </div>

            <div  style="line-height: 1.5rem;border-top: 1px solid gainsboro;">
              <span class="option" style="color: #5a5a5a;font-size: 12px">【近期开课】</span>
              <div class="option">
                <span class="pricetitle">{{item.courseName}} ¥{{item.price || '0.00'}}</span>
              </div>
            </div>


          </div>
        </div>
      </div>

        <div class="shopcount" v-for="(item,index) in clubs" @click="gotoclubs(1,index)">
          <div class="left-img">
            <img :src="formatImg(item.picName)" alt="">
          </div>
          <div class="right-content">
            <h3 v-text="item.title"></h3>
            <p v-text="item.desc"></p>
          </div>
        </div>


        <div class="bottomdiv">
          <span v-if="rote" class="uptext">---上拉加载---</span>
          <img v-if="load" class="publicfont" src="../../../assets/images/timg.gif">
          <span v-if="overlate" class="uptext">数据已全部加载</span>
        </div>
      </div>
      <!--琴馆结束-->
      <!--古琴课程的-->
      <div class="storebox" v-if="headerindex==1">
        <div class="shopcount" v-if="ifCourse">
          <h3 style="height: 5rem;line-height: 5rem;text-align: center;width: 100%;font-size: 16px;color: #8d8d8d;">
            对不起，没有搜索到合适的课程！</h3>
        </div>
        <div class="liketitle" v-if="ifCourse">
          <p>您可能喜欢</p><span>广告</span>
        </div>
        <div class="storebox" v-if="ifCourse">
          <div class="shop" v-for="(item,index) in course1" @click="gotocourse(2,index)">
            <div class="ableimg">
              <img class="oimg" :src="formatImg(item.images)">
              <p class="ableop">{{item.clubName}}</p>
            </div>
            <div class="textcount">
              <div class="countp" style="font-weight: bolder;font-size: 14px">
                {{item.courseName}}
                <span class="ospan" :style="'border-color:' + typeColor(item.courseType) + '; color:' + typeColor(item.courseType)">{{item.courseType | courseTypeText}}</span>
                <span class="ospan" style="color: #b4e7d8;border-color: #b4e7d8" v-show="item.courseType == '1'">{{item.level | levelText}}</span>
              </div>
              <div class="star">
                <i style="color: #ff8500; font-size: 14px;" class="iconfont icon-xingxing1"
                   v-for="i in parseInt(item.overallScore)"></i><i
                      style="color: #bfbfbf; font-size: 14px;" class="iconfont icon-xingxing1"
                      v-for="i in (5 - parseInt(item.overallScore))"></i>
                <span style="color:#ff8500; margin-left: 0.2rem; font-size: 14px;">{{item.overallScore}} / 5</span>
                <span class="distance">{{item.distance}}km</span>
              </div>

              <p class="pricehour">&yen;{{item.coursePrice}}</p>
              <p style="line-height: 1.5rem; font-size: 12px;color: #5a5a5a;">[开课日期]{{item.startDate}} ~ {{item.endDate | noYear}}</p>
            </div>
          </div>
        </div>

        <div class="shopcount" v-for="(item,index) in course" @click="gotocourse(1,index)">
          <div class="left-img">
            <img :src="formatImg(item.images)" alt="">
          </div>
          <div class="right-content">
            <h3 v-text="item.title"></h3>
            <p v-text="item.courseDesc"></p>
          </div>
        </div>
        <div class="bottomdiv">
          <span v-if="rote" class="uptext">---上拉加载---</span>
          <img v-if="load" class="publicfont" src="../../../assets/images/timg.gif">
          <span v-if="overlate" class="uptext">数据已全部加载</span>
        </div>
      </div>
      <!--古琴课程的结束-->
      <!--古琴产品-->
      <div class="storebox" v-if="headerindex==2">
        <div class="shopcount">
          <h3 style="height: 5rem;line-height: 5rem;text-align: center;width: 100%;font-size: 16px;color: #8d8d8d;">
            对不起，暂无数据！</h3>
        </div>
      </div>
      <!--古琴产品的结束-->
    </div>
    <!--古琴文化-->
    <div class="storebox" v-if="headerindex==3">
      <div class="shopcount" v-show="ifCulture">
        <h3 style="height: 5rem;line-height: 5rem;text-align: center;width: 100%;font-size: 16px;color: #8d8d8d;">
          对不起，没有搜索到合适的内容！</h3>
      </div>
      <div class="shopcount1" v-for="(item,index) in culture" @click="gotoculture(index)">
        <div class="culWrap" :style="{backgroundImage:'url(' + formatImg(item.cover) + ')'}">
          <p v-text="item.title"></p>
        </div>
        <p class="edittime" v-text="item.editTime"></p>
      </div>
      <div class="bottomdiv">
        <span v-if="rote" class="uptext">---上拉加载---</span>
        <img v-if="load" class="publicfont" src="../../../assets/images/timg.gif">
        <span v-if="overlate" class="uptext">数据已全部加载</span>
      </div>
    </div>
    <!--古琴文化的结束-->
  </div>
</body>
</html>
<script type="text/javascript" src="../../../assets/js/api.js"></script>
<script type="text/javascript" src="../../../assets/js/public.js"></script>
<script type="text/javascript" src="../../../assets/iconfont/iconfont.js"></script>
<script type="text/javascript" src="../../../assets/js/fastclick.js"></script>
<script>
  new FastClick(document.body);
</script>
<script type="text/javascript" src="../../../assets/js/vue.min.js"></script>
<script type="text/javascript" src="../../../assets/js/vue-resource.js"></script>
<script type="text/javascript" src="../../../assets/js/index.js"></script>
<script type="text/javascript">
  var app = new Vue({
    el: '#app',
    data: {
      topStatus: '',
      selected: 0,
      statusindex: '',
      nativeindex: null,
      changenumindex: null,
      changetypeindex: null,
      changelevelindex: null,
      changestoreindex: null,
      detailsindex: 0,
      headerindex: 0,
      minindex: -1,
      catchnum: 0,
      headerlist: [
        {
          name: '琴馆'
        },
        {
          name: '课程'
        },
        {
          name: '产品'
        },
        {
          name: '文化'
        }
      ],
      searchBox: '',
      ifClub: false,
      ifCourse: false,
      ifCulture: false,
      clubs: [],
      clubs1: [],
      course: [],
      course1: [],
      culture: [],
      rote: false,
      overlate: false,
      page: [1, 1, 1],
      totalPage: [1, 1, 1],
      load: false,
      start: 1,
      searchvalue: '',
      firstCount: 0,
      currentLoc: '',
      modal: false
    },
    filters: {
      courseTypeText: function (courseType) {
        switch (courseType) {
          case '1':
            return '定期课程';
          case '2':
            return '免费体验课';
          case '3':
            return '随到随学';
        }
      },
      levelText: function (level) {
        switch (level) {
          case '1':
            return '入门级';
          case '2':
            return '提高班';
          case '3':
            return '进修班';
        }
      }
    },
    watch: {
      firstCount: function (val) {
        if (val == 1) {
          loadEnd();
        }
      }
//      'catchnum': function (value) {
//        if (value == 0) {
//          loadEnd();
//        }
//      }
    },
    created: function () {
      apiready = function () {
        app.searchBox = api.pageParam.searchBox;
        app.homeSearchClub(1, function () {
          app.firstCount++;
        });
        app.searchvalue = api.pageParam.searchvalue;
//              判断主页搜索进入还是发现搜索进入
        if (app.searchvalue == 1) {
          app.headerlist.splice(2, 2);
          app.laber();
        }
        api.addEventListener({
          name: 'startsearch'
        }, function (ret, err) {
          app.start = 50;
          app.searchBox = ret.value.searchBox;
          app.headerbtn(app.headerindex);
        });
        api.addEventListener({
          name: 'scrolltobottom',
          extra: {
            threshold: 30 //设置距离底部多少距离时触发，默认值为0，数字类型
          }
        }, function (ret, err) {
          app.load = true;
          app.rote = false;
          app.overlate = false;
          switch (app.selected) {
            case 0: {
              if (app.page[0] <= app.totalPage[0]) {
                app.homeSearchClub(2);
              } else {
                app.load = false;
                app.rote = false;
                app.overlate = true;
              }
              break;
            }
            case 1: {
              if (app.page[1] <= app.totalPage[1]) {
                app.homeSearchCourse(2);
              } else {
                app.load = false;
                app.rote = false;
                app.overlate = true;
              }
              break;
            }
            case 3: {
              if (app.page[2] <= app.totalPage[2]) {
                app.homeSearchCulture(2);
              } else {
                app.load = false;
                app.rote = false;
                app.overlate = true;
              }
              break;
            }
          }
        });
      };
    },
    methods: {
      typeColor: function (courseType) {
        switch (courseType) {
          case '1':
            return '#f68778';
          case '2':
            return '#80b8ff';
          case '3':
            return '#ff941f';
        }
      },


      change: function (index) {
        app.nativeindex = index;
      },
      changenum: function (index) {
        app.changenumindex = index;
      },
      changetype: function (index) {
        app.changetypeindex = index;
      },
      changelevel: function (index) {
        app.changelevelindex = index;
      },
      changestore: function (index) {
        app.changestoreindex = index;
      },
//改变tab
      headerbtn: function (index) {
        app.headerindex = index;
        app.load = false;
        app.rote = false;
        app.overlate = false;
        switch (index) {
          case 0 : {
            app.selected = 0;
            if (app.clubs.length === 0 || app.start > 1) {
              app.page.splice(0, 1, 1);
              app.homeSearchClub(1);
            }
            break;
          }
          case 1 : {
            app.selected = 1;
            if (app.course.length === 0 || app.start > 1) {
              app.page.splice(1, 1, 1);
              app.homeSearchCourse(1);
            }
            break;
          }
          case 3 : {
            app.selected = 3;
            if (app.culture.length === 0 || app.start > 1) {
              app.page.splice(2, 1, 1);
              app.homeSearchCulture(1);
            }
            break;
          }
        }
      },

      laber: function () {
        app.catchnum++
      },
      homeSearchClub: function (ref, callback) {
        var post = {
          cmd: 'homeSearchClub',
          searchBox: app.searchBox,
          page: app.page[0],
          perPage: 5
        };
        sendAjax(this, post, function (ret) {
          if (ref === 1) {
            if (ret.data.proList.length === 0) {
              app.ifClub = true;
              app.clubs = [];
              app.clubPickList(callback);
            } else {
              app.ifClub = false;
              app.clubs = ret.data.proList;
              app.totalPage[0] = ret.data.totalPage;
              if (callback) {
                callback();
              }
            }
            app.page[0]++;
            app.rote = true;
            app.load = false;
          } else {
            app.clubs = app.clubs.concat(ret.data.proList);
            app.page[0]++;
            app.rote = true;
            app.load = false;
          }

        })
      },
      homeSearchCourse: function (ref, callback) {
        var post = {
          cmd: 'homeSearchCourse',
          searchBox: app.searchBox,
          page: app.page[1]
        };
        sendAjax(app, post, function (ret) {
          if (ref === 1) {
            if (ret.data.proList.length === 0) {
              app.ifCourse = true;
              app.course = [];
              app.coursePickList(callback);
            } else {
              app.ifCourse = false;
              app.course1 = false;
              app.course = ret.data.proList;
              app.totalPage[1] = ret.data.totalPage;
              app.page[1]++;
              app.rote = true;
              app.load = false;
            }
            if (callback) {
              callback();
            }
          } else {
            app.course = app.course.concat(ret.data.proList);
            app.page[1]++;
            app.rote = true;
            app.load = false;
          }

        })
      },
      homeSearchCulture: function (ref, callback) {
        var post = {
          cmd: 'homeSearchCulture',
          searchBox: app.searchBox,
          page: app.page[2],
          perPage: 5
        };
        sendAjax(app, post, function (ret) {
          if (ref === 1) {
            if (ret.data.proList.length === 0) {
              app.ifCulture = true;
              app.culture = [];
            } else {
              app.ifCulture = false;
              app.culture = ret.data.proList;
              app.totalPage[2] = ret.data.totalPage;
              app.page[2]++;
              app.rote = true;
              app.load = false;
            }
            if (callback) {
              callback();
            }
          } else {
            app.culture = app.culture.concat(ret.data.proList);
            app.page[2]++;
            app.rote = true;
            app.load = false;
          }
        })
      },
      gotoclubs: function (type, ind) {
        var theId = '';
        if (type === 1) {
          theId = app.clubs[ind].id;
        } else {
          theId = app.clubs1[ind].id;
        }
        api.openWin({
          name: 'catchdetails',
          url: '../catchdetails/catchdetails_win.html',
          pageParam: {
            clubId: theId
          }
        });
      },
      gotocourse: function (type, ind) {
        var courseid = '';
        if (type == 1) {
          courseid = app.course[ind].id;
        } else {
          courseid = app.course1[ind].courseId;
        }
        api.openWin({
          name: 'catchdetails',
          url: '../catchdetails/catchdetails_win.html',
          pageParam: {
            courseId: courseid
          }
        });
      },
      gotoculture: function (ind) {
        var id = app.culture[ind].firstLevelCateId;
        switch (id) {
          case '1': {
            //琴界新闻
            api.openWin({
              name: 'newdetails_win',
              url: '../../tools/morenew/newdetails_win.html',
              pageParam: {
                cateid: app.culture[ind].cateId,
                articleid: app.culture[ind].id
              }
            });
            break;
          }
          case '2': {
            //古琴名家
            api.openWin({
              name: 'revisehome_win',
              url: '../../tools/people/revisehome_win.html',
              pageParam: {
                cateid: app.culture[ind].cateId,
                articleid: app.culture[ind].id
              }
            });
            break;
          }
          case '3': {
            //琴器
            api.openWin({
              name: 'albumhome_win',
              url: '../../tools/album/albumhome_win.html',
              pageParam: {
                cateid: app.culture[ind].cateId,
                articleid: app.culture[ind].id
              }
            });
            break;
          }
          case '4': {
            //琴曲
            api.openWin({
              name: 'listendetails_win',
              url: '../../tools/listen/listendetails_win.html',
              pageParam: {
                cateid: app.culture[ind].cateId,
                articleid: app.culture[ind].id
              }
            });
            break;
          }
          case '5': {
            //琴谱
            api.openWin({
              name: 'musicdetails_win',
              url: '../../tools/music/musicdetails_win.html',
              pageParam: {
                cateid: app.culture[ind].cateId,
                articleid: app.culture[ind].id
              }
            });
            break;
          }
          case '6': {
            //琴学
            api.openWin({
              name: 'videodetails_win',
              url: '../../tools/video/videodetails_win.html',
              pageParam: {
                cateid: app.culture[ind].cateId,
                articleid: app.culture[ind].id
              }
            });
            break;
          }
          case '23': {
            //古琴工具书
            api.openWin({
              name: 'details_win',
              url: '../../tools/book/details_win.html',
              pageParam: {
                cateid: app.culture[ind].cateId,
                articleid: app.culture[ind].id
              }
            });
            break;
          }
        }
      },
      clubPickList: function (callback) {
        app.getLocation(
          function () {
            var post = {
              cmd: 'clubPickList',
              cityCode: getcitycode(),
              operateYear: '0',
              clubLevel: '0',
              courseType: '0',
              courseLevel: '0',
              brand: '0',
              productTag: '0',
              currentposition: app.currentLoc,
              app: '1',
              page: '1',
              perPage: '10'
            };
            sendAjax(app, post, function (ret) {
              app.clubs1 = ret.data.proList;
              if (callback) {
                callback();
              }
            })
          }
        );

      },
      coursePickList: function (callback) {
        app.getLocation(
          function () {
            var post = {
              cmd: 'coursePickList',
              cityCode: getcitycode(),
              operateYear: '0',
              clubLevel: '0',
              courseType: '0',
              courseLevel: '0',
              personCount: '0',
              currentposition: app.currentLoc,
              app: '1',
              page: '1',
              perPage: '10'
            };
            sendAjax(app, post, function (ret) {
              app.course1 = ret.data.proList;
              if (callback) {
                callback();
              }
            })
          }
        );

      },
//      获取当前位置
      getLocation: function (callback) {
        var aMap = api.require('aMap');
        aMap.open({
          rect: {
            x: 0,
            y: 0,
            w: 0,
            h: 0
          }
        }, function () {
          aMap.getLocation(function (ret, arr) {
              if (ret.status) {
                app.currentLoc = ret.lon + ',' + ret.lat;
                if (callback) {
                  callback();
                }
              } else {
              }
            }
          )
        })
      }
    }
  })
</script>